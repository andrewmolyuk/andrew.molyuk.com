---
title: 'Так монорепа или полирепа'
date: 2023-09-11T12:49:23+03:00
tags: ['golang', 'микросервисы', 'структура', 'монорепа', 'полирепа']
draft: false
---

С развитием архитектурного дизайна веб-приложений, микросервисы стали успешным новым трендом в построении ландшафта
приложений. Вместе с прогрессом в архитектуре приложений, протоколы транспортных методов, такие как REST и gRPC,
становятся более эффективными и быстрыми. Кроме того, контейнеризация микросервисных приложений значительно способствует
гибкой разработке и быстрой доставке. Все развивается и принимает новеые принципы и подходы. Но вопрос о том, как лучше
всего организовать структуру проекта, остается открытым. В этой статье я расскажу о двух подходах к организации
структуры проекта: монорепа и полирепа.

Я прекрасно понимаю, что тема вылизана в интернете и святая война между сторонниками и противниками того и другого
подхода не утихает. Но я все же решил поделиться своими мыслями на этот счет.

<!--more-->

## Монорепа

Так что же такое монорепа? Монорепа - это подход к организации структуры проекта, при котором весь код проекта хранится
в одном репозитории. Например, мы можем хранить фронтовой код и код бэкенда в одном репозитории. Такой подход позволяет
нам легко управлять кодом и развертывать его вместе. Кроме того, это позволяет нам легко управлять зависимостями между
проектами в репозитории. Кроме этого это позволяет хранить все конфигурации инфраструктуры, тесты и документацию в одном
месте.

Такие гиганты индустрии как Google, Facebook, Twitter и Uber используют монорепу для своих проектов. Но это не значит,
что монорепа - это панацея. У этого подхода есть свои недостатки. Основным недостатком является то, что при большом
объеме кода начинают расти зависимости между проектами и это влияет на архитектурные решения, что в итоге проводит к
монолитным зависимостям в проекте. Другими словами, структура кода начинает влиять на архитектурные решения, что не есть
хорошо.

## Полирепа

Полирепа - это подход к организации структуры проекта, при котором каждый проект хранится в отдельном репозитории.
Основными преимуществами такого разделения можно назвать низкую связанность между проектами и возможность использовать
разные языки программирования для разных проектов. Как результат, такими репозиториями намного легче управлять и
развивать.

Но у этого подхода есть и свои недостатки. Основным недостатком является то, что при большом количестве проектов,
управление ими становится сложным. Но с другой стороны, это можно решить с помощью инструментов для управления
множеством репозиториев.

## Что же выбрать?

Давайте посмотрим на критерии отбора и затем уже станет понятно что подходит именно для Вашего специфического проекта.

### Зависимости

В монорепе у нас всегда идет работа с последней версией и весь код, за редким исключением, является общим. Очень легко
затронуть общий код и сломать его, что требует дополнительного тестирования и валидации.

В полирепе общий код публикуется как отдельные проекты и более управляемы и прозрачны. Но при этом приходится работать с
разными версиями библиотек, что требует дополнительных усилий.

### Командная работа

Монорепа прозрачна для всех команд и потому код намного легче стандартизировать и формализовать. Потому для любых
команд, которые работают вместе над всем проектом это преимущество.

Полирепа же однозначно более эффективна, когда у Вас есть удаленные команды и требуется гранулярный подход для
управления доступом к коду.

### DevOps

Монорепа легко собирается полностью если необходимо выпустить версию всех компонент и напротив, полирепа облегчает
управление жизненным циклом каждого из проектов системы вне зависимости от структуры репозитория. Микросервисная
архитектура уменьшает необходимость в выпуске крупных версий.

### Рефакторинг

Монорепа позволяет легко производить изменения в коде и отслеживать все зависимости. В полирепе приходится делать
изменения во всех репозиториях и зачастую обрабатывать более сложные сценарии миграции на новые интерфейсы.

## Заключение

Я постарался сказать свои пять копеек по поводу того, что такое монорепа и полирепа и какие основные критерии выбора.
Каждое решение имеет свои преимущества и недостатки, а потому в каждом конкретном случае необходимо выбирать то, что
подходим лучше всего Вашему проекту.

В дополнение хотел бы добавить, что любой проект с течением времени принимает очертания и структуру подобную самой
структуре организации. Поэтому на старте в малой команде я всегда использую монорепу, а затем периодически пересматриваю
необходимость изменений с течением времени. И вот уже в двух компаниях у меня был опыт органического перехода от
монолита в монорепе к микросервисам в полирепе. Поэтому на старте смело начинайте с монорепы, но затем будьте готовы
менять структуру кода.

Надеюсь данная статья была полезна и интересна. Если у Вас есть вопросы или комментарии, то пишите в комментариях под
этой статьей. Буду рад ответить.
